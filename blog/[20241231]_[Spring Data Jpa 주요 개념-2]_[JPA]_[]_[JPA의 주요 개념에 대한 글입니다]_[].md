# 영속성 컨텍스트의 특징

## 1. 1차 캐시
- **영속성 컨텍스트 내부에 1차 캐시가 존재**하며, 동일 트랜잭션 내에서는 같은 조회 쿼리를 두 번 호출하지 않습니다.
- 영속 상태의 객체는 **ID(식별자) 값이 반드시 존재**하며, 1차 캐시에서 관리됩니다.
- 조회 프로세스:
  1. **1차 캐시에 데이터가 있는 경우**: 1차 캐시에서 바로 값을 반환.
  2. **1차 캐시에 데이터가 없는 경우**: DB에서 조회한 후 1차 캐시에 저장하고 반환.

---

## 2. 쓰기 지연
- **트랜잭션 시작 시**:
  - 변경 사항(SQL문)은 즉시 실행되지 않고, **쓰기 지연 SQL 저장소**에 저장됩니다.
- **트랜잭션 커밋 시**:
  - 저장된 SQL문이 **Flush**되어 DB에서 실행되고 트랜잭션이 완료됩니다.
- 장점:
  - 트랜잭션에서 여러 쿼리를 모아 한 번에 처리함으로써 **DB와의 커넥션을 줄일 수 있음**.
- 예외:
  - ID가 없는 엔티티(특이 케이스)는 쓰기 지연 처리 대상에서 제외됩니다. 이 경우 ID 생성 후 저장됩니다.

---

## 3. 동일성 보장
- **1차 캐시에 저장된 값은 항상 동일한 객체를 반환**합니다.
- 동일 트랜잭션 내에서 동일한 식별자를 가진 엔티티를 조회할 경우:
  - DB를 다시 조회하지 않고 1차 캐시의 값을 반환.
  - 이를 통해 **성능 향상**이 가능합니다.

---

## 4. 변경 감지
- **변경된 엔티티를 감지**하여 변경 사항을 반영합니다.
- 프로세스:
  1. 1차 캐시에서 엔티티의 변경된 데이터를 확인.
  2. 변경 사항을 감지하여 업데이트 쿼리를 추가.
  3. **Flush** 시 SQL문이 실행되어 변경 사항이 DB에 반영.

---

# Spring Data JPA

Spring Data JPA는 JPA를 더 쉽게 사용할 수 있도록 만든 **Spring 모듈**입니다.  
- 기존 JPA에서는 **EntityManager**를 직접 선언하고 사용해야 했습니다.
- Spring Data JPA는 EntityManager를 자동으로 관리하며, 개발자가 직접 선언할 필요가 없습니다.
- 추가적으로, Spring Data JPA는 다음과 같은 이점을 제공합니다:
  - 간편한 **CRUD 구현**: Repository 인터페이스만으로 기본 CRUD 기능 제공.
  - **메소드 이름 기반 쿼리**: 메소드 이름을 통해 동적으로 쿼리를 생성.
  - **JPQL 및 Native Query 지원**: 복잡한 쿼리 작성 가능.
  - 데이터 접근 계층 구현을 간소화하여 **생산성 향상**.
